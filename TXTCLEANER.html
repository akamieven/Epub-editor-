<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ø±Ø± ÙˆÙ…Ù†Ø¸Ù ÙˆØ¯Ø§Ù…Ø¬ Ù…Ù„ÙØ§Øª TXT ğŸ“•</title>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Reset and Global Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

                @font-face {
            font-family: 'BooksFont';
            src: url('booksfont.ttf') format('truetype'); 
            font-weight: normal;
            font-style: normal;
        }

        :root { --primary: #10b981; --bg: #f3f4f6; --card: #ffffff; }
        body { 
            font-family: 'BooksFont', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: var(--bg); 
            color: #1f2937; 
            margin: 0; 
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            min-height: 100vh; 
        }

        /* Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ - Grid Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© */
        .app-container {
            width: 100%;
            max-width: 1400px;
            margin: auto;
            display: grid;
            grid-template-columns: 280px 1fr; 
            gap: 20px;
            background-color: #ffffff;
            border-radius: 18px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05); 
            padding: 30px;
        }

        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ (Controls) */
        .sidebar {
            background-color: #ffffff;
            padding-left: 10px;
        }

        h1 {
            color: #111827; 
            font-size: 1.6em;
            font-weight: 700;
            margin-bottom: 30px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e5e7eb;
        }

        /* Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙØ±Ø¯ÙŠØ© */
        .control-group {
            margin-bottom: 25px;
            padding: 15px 10px;
            border-radius: 10px;
            background-color: #fcfcfd;
            border: 1px solid #f3f4f6;
            transition: box-shadow 0.3s;
        }
        .control-group:hover {
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.04);
        }

        .control-group h3 {
            font-size: 1em;
            font-weight: 600;
            color: #374151;
            margin-bottom: 15px;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 8px;
        }

        /* Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± */
        label {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            color: #4b5563;
            font-size: 0.9em;
        }
        input[type="text"], input[type="file"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 0.9em;
            background-color: #ffffff;
            margin-bottom: 15px;
        }
        input[type="file"] { border: none; padding: 0; cursor: pointer; }
        button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: white;
            margin-top: 10px;
            transition: background-color 0.2s, transform 0.1s;
        }
        button:active { transform: scale(0.99); }

        .action-btn { background-color: #3b82f6; }
        .action-btn:hover { background-color: #2563eb; }
        .delete-btn { background-color: #ef4444; }
        .delete-btn:hover { background-color: #dc2626; }
        #downloadButton { background-color: #10b981; margin-top: 25px; font-size: 1.05em; }
        #downloadButton:hover { background-color: #059669; }
        #applyOrderButton { background-color: #0087ff; }
        #applyOrderButton:hover { background-color: #0073e6; }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            font-size: 0.9em;
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­Ø±Ø± */
        .editor-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 10px;
        }

        textarea {
            width: 100%;
            flex-grow: 1; 
            min-height: 700px;
            padding: 20px;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            resize: vertical;
            font-size: 15px;
            direction: ltr; 
            text-align: left;
            background-color: #fcfcfd;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.04);
            transition: border-color 0.3s;
        }
        textarea:focus {
            border-color: #0087ff;
            outline: none;
        }

        /* ======================================= */
        /*  */
        /* ======================================= */
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± (Chrome/Safari/Opera) */
        textarea::-webkit-scrollbar {
            width: 18px; /* Ø²ÙŠØ§Ø¯Ø© ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ù‹Ø§ Ù„Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø¥Ù…Ø³Ø§Ùƒ Ø¨Ø§Ù„Ù„Ù…Ø³ */
        }

        /* Ù…Ù‚Ø¨Ø¶ Ø§Ù„ØªÙ…Ø±ÙŠØ± (Scrollbar Thumb) */
        textarea::-webkit-scrollbar-thumb {
            background-color: #4b5563; /* Ø±Ù…Ø§Ø¯ÙŠ Ø¯Ø§ÙƒÙ† Ù„Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ÙˆØ¶ÙˆØ­ */
            border-radius: 9px; /* Ù†ØµÙ Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø±ÙŠØ· */
            border: 5px solid #fcfcfd; /* Ø­Ø§ÙØ© ÙˆØ§Ø³Ø¹Ø© Ù„Ø²ÙŠØ§Ø¯Ø© Ø­Ø¬Ù… Ø§Ù„Ù…Ù‚Ø¨Ø¶ Ø§Ù„ÙØ¹Ù„ÙŠ */
        }

        textarea::-webkit-scrollbar-thumb:hover {
            background-color: #1f2937; /* Ø£ØºÙ…Ù‚ Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ§Ø¹Ù„ */
        }

        /* Ù…Ø³Ø§Ø± Ø§Ù„ØªÙ…Ø±ÙŠØ± (Scrollbar Track) */
        textarea::-webkit-scrollbar-track {
            background: #e5e7eb; /* Ø®Ù„ÙÙŠØ© Ø±Ù…Ø§Ø¯ÙŠØ© ÙØ§ØªØ­Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ù„ØªÙ…ÙŠÙŠØ²Ù‡ */
        }
        
        /* ØªØµÙ…ÙŠÙ… Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„ÙØ§Øª (Ù„Ù… ÙŠØªØºÙŠØ±) */
        #fileList {
            list-style: none;
            padding: 0;
            margin-top: 10px;
            background-color: #ffffff; 
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .file-item {
            padding: 10px;
            border-bottom: 1px solid #f3f4f6;
            cursor: grab; 
            font-size: 0.85em;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #ffffff;
            position: relative;
            user-select: none; 
            -webkit-user-select: none; 
            touch-action: none; 
        }
        .file-item:last-child { border-bottom: none; }
        .file-item.dragging {
            opacity: 0.5;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); 
            position: fixed; 
            z-index: 1000;
            width: 260px;
        }
        .file-item.over { background-color: #e5f1ff; }
        .file-item span::before {
            content: 'â˜°'; 
            margin-left: 10px;
            color: #9ca3af; 
            font-size: 1.2em;
        }
        
        /* ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ (Media Query) */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .app-container { grid-template-columns: 1fr; gap: 15px; padding: 15px; }
            .sidebar { padding: 0; }
            h1 { text-align: center; font-size: 1.5em; margin-bottom: 20px; }
            .editor-section { min-height: 400px; }
            textarea { min-height: 400px; }
            .control-group { padding: 12px; }
            .file-item.dragging {
                width: calc(100% - 20px); 
            }
        }
        
    </style>
</head>
<body>

    <div class="app-container">
        
        <div class="sidebar">
            <h1>Ù…Ø­Ø±Ø± ÙˆÙ…Ù†Ø¸Ù ÙˆØ¯Ø§Ù…Ø¬ Ù…Ù„ÙØ§Øª TXTğŸ“•</h1>
<div class="Epub-Editor"> 
    <button 
        onclick="window.location.href='index.html'" 
        class="Epub-Editor-button">
        Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Epub Editor
    </button>
</div>

            <div class="control-group">
                <h3>ğŸ“‚ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª</h3>
                <label for="fileInput">Ø§Ø®ØªØ± Ù…Ù„Ù TXT ÙˆØ§Ø­Ø¯ Ø£Ùˆ Ø£ÙƒØ«Ø±:</label>
                <input type="file" id="fileInput" accept=".txt" multiple>
            </div>
            
            <div class="control-group">
                <h3> ØªØ±ØªÙŠØ¨ Ù…Ù„ÙØ§Øª Ø§Ù„Ø¯Ù…Ø¬ (Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª)</h3>
                
                <ul id="fileList">
                    <li class="file-item" style="text-align: center; color: #6b7280; cursor: default;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„ÙØ§Øª Ù…ÙØ­Ù…Ù„Ø©</li>
                </ul>
                
                <button onclick="mergeAndDisplayFiles()" id="applyOrderButton">ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ±ØªÙŠØ¨ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø¯Ù…Ø¬</button>
            </div>

            <div class="control-group">
                <h3>ğŸ› ï¸ Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ</h3>
                <button onclick="removePageNumbers()" class="action-btn">ØªÙ†Ø¸ÙŠÙ ØªØ±Ù‚ÙŠÙ… Ø§Ù„ØµÙØ­Ø§Øª (ØªÙ„Ù‚Ø§Ø¦ÙŠ)</button>
                <button onclick="removeSoftLineBreaks()" class="action-btn"> Ø¥Ø²Ø§Ù„Ø© ÙÙˆØ§ØµÙ„ Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ø²Ø§Ø¦Ø¯Ø© (ØªÙ„Ù‚Ø§Ø¦ÙŠ)</button>
            </div>

            <div class="control-group">
                <h3>ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ø£Ø³Ø·Ø±</h3>
                <label for="searchWord">Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø­Ø°Ù Ø³Ø·Ø±Ù‡Ø§:</label>
                <input type="text" id="searchWord" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø£Ùˆ Ø¹Ø¨Ø§Ø±Ø©">
                <div class="checkbox-group">
                    <input type="checkbox" id="deleteLineCheckbox" checked>
                    <label for="deleteLineCheckbox">ØªÙØ¹ÙŠÙ„ Ø­Ø°Ù Ø§Ù„Ø³Ø·Ø± Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</label>
                </div>
                <button onclick="processText()" class="delete-btn">ØªØ·Ø¨ÙŠÙ‚ Ø­Ø°Ù Ø§Ù„Ø³Ø·Ø±</button>
            </div>
            
            <button onclick="downloadModifiedText()" id="downloadButton">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…ÙØ¹Ø¯Ù‘ÙÙ„</button>

        </div>
        
        <div class="editor-section">
            <textarea id="fileContent" placeholder="Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø°ÙŠ ØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡ ÙˆÙ…Ø¹Ø§Ù„Ø¬ØªÙ‡ Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§..."></textarea>
        </div>

    </div>

    <script>
        const fileInput = document.getElementById('fileInput');
        const fileContentTextarea = document.getElementById('fileContent');
        const searchWordInput = document.getElementById('searchWord');
        const deleteLineCheckbox = document.getElementById('deleteLineCheckbox');
        const fileListElement = document.getElementById('fileList');

        let originalFileName = 'merged_and_modified_text.txt'; 
        let loadedFiles = []; 
        let fileContents = {}; 
        
        let dragSrcEl = null; 
        let touchSrcEl = null; 

        // **********************************************
        // *************** ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ±ØªÙŠØ¨ (Mouse & Touch) ***************
        // **********************************************
        
        function renumberListItems() {
            const items = fileListElement.querySelectorAll('.file-item');
            items.forEach((item, index) => {
                const span = item.querySelector('span');
                if (span) {
                    const filename = item.getAttribute('data-filename');
                    span.innerHTML = `<span>${index + 1}. ${filename}</span>`;
                }
            });
        }

        // --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø§ÙˆØ³ (Mouse Events) ---

        function handleDragStart(e) {
            dragSrcEl = this;
            e.dataTransfer.effectAllowed = 'move';
            setTimeout(() => this.classList.add('dragging'), 0);
        }

        function handleDragOver(e) {
            e.preventDefault(); 
            e.dataTransfer.dropEffect = 'move';
            if (this !== dragSrcEl) {
                this.classList.add('over');
            }
            return false;
        }
        
        function handleDragLeave() {
            this.classList.remove('over');
        }

        function handleDrop(e) {
            e.stopPropagation(); 
            this.classList.remove('over'); 

            if (dragSrcEl !== this) {
                const parent = dragSrcEl.parentNode;
                const targetRect = this.getBoundingClientRect();
                const isDroppedBefore = e.clientY < (targetRect.top + targetRect.height / 2);
                
                if (isDroppedBefore) {
                    parent.insertBefore(dragSrcEl, this);
                } else {
                    parent.insertBefore(dragSrcEl, this.nextSibling);
                }
                
                renumberListItems();
            }
            return false;
        }

        function handleDragEnd() {
            this.classList.remove('dragging');
            fileListElement.querySelectorAll('.file-item').forEach(item => item.classList.remove('over'));
        }

        // --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù„Ù…Ø³ (Touch Events) ---

        function getTargetItem(y) {
            const items = fileListElement.querySelectorAll('.file-item');
            let closestItem = null;
            let minDistance = Infinity;

            items.forEach(item => {
                if (item === touchSrcEl) return; 

                const rect = item.getBoundingClientRect();
                const distance = Math.abs(y - (rect.top + rect.height / 2));
                
                if (distance < minDistance) {
                    minDistance = distance;
                    closestItem = item;
                }
                item.classList.remove('over');
            });
            
            if (closestItem) {
                closestItem.classList.add('over');
            }
            return closestItem;
        }

        function handleTouchStart(e) {
            if (e.touches.length !== 1) return;
            
            e.preventDefault(); 

            touchSrcEl = this;
            touchSrcEl.classList.add('dragging');
            
            const touch = e.touches[0];
            const rect = touchSrcEl.getBoundingClientRect();
            
            touchSrcEl.startX = touch.clientX - rect.left;
            touchSrcEl.startY = touch.clientY - rect.top;
            
            touchSrcEl.style.position = 'fixed';
            touchSrcEl.style.top = `${touch.clientY - touchSrcEl.startY}px`;
            touchSrcEl.style.left = `${touch.clientX - touchSrcEl.startX}px`;
        }

        function handleTouchMove(e) {
            if (!touchSrcEl) return;
            e.preventDefault(); 

            const touch = e.touches[0];
            
            touchSrcEl.style.top = `${touch.clientY - touchSrcEl.startY}px`;
            touchSrcEl.style.left = `${touch.clientX - touchSrcEl.startX}px`;
            
            const targetItem = getTargetItem(touch.clientY);
        }

        function handleTouchEnd(e) {
            if (!touchSrcEl) return;

            touchSrcEl.classList.remove('dragging');
            touchSrcEl.style.position = '';
            touchSrcEl.style.top = '';
            touchSrcEl.style.left = '';
            
            const dropY = e.changedTouches[0].clientY;
            const targetItem = getTargetItem(dropY);
            
            if (targetItem && targetItem !== touchSrcEl) {
                const parent = touchSrcEl.parentNode;
                const targetRect = targetItem.getBoundingClientRect();
                const isDroppedBefore = dropY < (targetRect.top + targetRect.height / 2);

                if (isDroppedBefore) {
                    parent.insertBefore(touchSrcEl, targetItem);
                } else {
                    parent.insertBefore(touchSrcEl, targetItem.nextSibling);
                }
                
                renumberListItems();
            }
            
            fileListElement.querySelectorAll('.file-item').forEach(item => item.classList.remove('over'));
            touchSrcEl = null;
        }


        // --- Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ† ---
        function initDragAndDrop() {
            const list = fileListElement;
            
            function addFileItemListeners() {
                const items = list.querySelectorAll('.file-item');

                items.forEach(item => {
                    item.removeEventListener('dragstart', handleDragStart);
                    item.removeEventListener('dragover', handleDragOver);
                    item.removeEventListener('dragleave', handleDragLeave);
                    item.removeEventListener('drop', handleDrop);
                    item.removeEventListener('dragend', handleDragEnd);
                    item.removeEventListener('touchstart', handleTouchStart);
                    item.removeEventListener('touchmove', handleTouchMove);
                    item.removeEventListener('touchend', handleTouchEnd);
                });

                items.forEach(item => {
                    if (item.getAttribute('data-filename')) {
                        // Mouse Events
                        item.setAttribute('draggable', true);
                        item.addEventListener('dragstart', handleDragStart);
                        item.addEventListener('dragover', handleDragOver);
                        item.addEventListener('dragleave', handleDragLeave);
                        item.addEventListener('drop', handleDrop);
                        item.addEventListener('dragend', handleDragEnd);
                        
                        // Touch Events (Ù„Ù„Ù‡Ø§ØªÙ)
                        item.addEventListener('touchstart', handleTouchStart);
                        item.addEventListener('touchmove', handleTouchMove);
                        item.addEventListener('touchend', handleTouchEnd);
                    }
                });
            }
            
            addFileItemListeners();
        }

        // **********************************************
        // *************** ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„Ø¯Ù…Ø¬ ***************
        // **********************************************
        
        function displayFileOrderList() {
            fileListElement.innerHTML = '';
            
            if (loadedFiles.length === 0) {
                 fileListElement.innerHTML = '<li class="file-item" style="text-align: center; color: #6b7280; cursor: default;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„ÙØ§Øª Ù…ÙØ­Ù…Ù„Ø©</li>';
                 return;
            }

            loadedFiles.forEach((file, index) => {
                const li = document.createElement('li');
                li.className = 'file-item';
                li.setAttribute('data-filename', file.name);
                li.innerHTML = `<span>${index + 1}. ${file.name}</span>`; 
                fileListElement.appendChild(li);
            });

            initDragAndDrop();
        }

        fileInput.addEventListener('change', function(event) {
            const files = Array.from(event.target.files);
            if (files.length === 0) return;
            
            loadedFiles = []; 
            fileContents = {}; 

            let filesToRead = files.length;
            
            files.forEach(file => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    fileContents[file.name] = e.target.result;
                    filesToRead--;
                    
                    if (filesToRead === 0) {
                        loadedFiles = files;
                        displayFileOrderList();
                        mergeAndDisplayFiles(true);
                        alert(`ØªÙ… ØªØ­Ù…ÙŠÙ„ ${files.length} Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­. ÙŠØ±Ø¬Ù‰ ØªØ±ØªÙŠØ¨Ù‡Ø§ Ø¨Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©.`);
                    }
                };
                
                reader.readAsText(file);
            });
            
            if (files.length === 1) {
                originalFileName = files[0].name;
            } else {
                 originalFileName = `${files[0].name.replace('.txt', '')}_MERGED.txt`;
            }
        });

        
        function mergeAndDisplayFiles(isInitialLoad = false) {
            const orderedListItems = fileListElement.querySelectorAll('.file-item');
            
            if (orderedListItems.length === 0 || (orderedListItems.length === 1 && orderedListItems[0].getAttribute('data-filename') === null)) {
                if (!isInitialLoad) alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø£ÙˆÙ„Ø§Ù‹.");
                return;
            }
            
            fileContentTextarea.value = '';
            let mergedText = '';
            let fileCount = 0;

            orderedListItems.forEach(item => {
                const fileName = item.getAttribute('data-filename');
                if (fileName && fileContents[fileName]) {
                    const fileSeparator = `\n\n=== START OF FILE: ${fileName} (Order: ${++fileCount}) ===\n\n`;
                    mergedText += fileSeparator + fileContents[fileName];
                }
            });

            fileContentTextarea.value = mergedText.trim();
            if (!isInitialLoad) {
                alert("âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙˆØ¯Ù…Ø¬ Ø§Ù„Ù…Ù„ÙØ§Øª ÙÙŠ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­Ø±Ø±.");
            }
        }


        // **********************************************
        // *************** ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø±Ù‰ ***************
        // **********************************************
        
        function processText() {
            const searchWord = searchWordInput.value.trim();
            const deleteLine = deleteLineCheckbox.checked;
            
            if (!searchWord) {
                alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ù„Ù„Ø¨Ø­Ø« Ø¹Ù†Ù‡Ø§.");
                return;
            }

            if (!deleteLine) {
                 alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªÙØ¹ÙŠÙ„ Ø®Ø§Ù†Ø© 'ØªÙØ¹ÙŠÙ„ Ø­Ø°Ù Ø§Ù„Ø³Ø·Ø± Ø¨Ø§Ù„ÙƒØ§Ù…Ù„' Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.");
                 return;
            }

            const originalText = fileContentTextarea.value;
            const lines = originalText.split('\n');
            let newLines = [];

            const searchRegex = new RegExp(`${searchWord}`, 'i');
            let linesDeletedCount = 0;

            for (const line of lines) {
                if (searchRegex.test(line)) {
                    linesDeletedCount++;
                } else {
                    newLines.push(line);
                }
            }
            
            fileContentTextarea.value = newLines.join('\n');
            alert(`âœ… ØªÙ…Øª Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Øµ Ø¨Ù†Ø¬Ø§Ø­. ØªÙ… Ø­Ø°Ù ${linesDeletedCount} Ø³Ø·Ø± ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø© "${searchWord}".`);
        }
        
        // Ø¬. Ø¯Ø§Ù„Ø© Ø¥Ø²Ø§Ù„Ø© ØªØ±Ù‚ÙŠÙ… Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ù…ÙØ­Ø¯Ù‘ÙØ«Ø© Ù„Ø¯Ø¹Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©)
        function removePageNumbers() {
            const contentTextarea = document.getElementById('fileContent');
            let newText = contentTextarea.value;
            let linesProcessed = 0;

            // Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ù -Ù©) ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (0-9)
            const allDigits = '[0-9Ù -Ù©]'; 

            // Ø§Ù„Ù†Ù…Ø· 1: Ø£Ø±Ù‚Ø§Ù… Ù…Ø³ØªÙ‚Ù„Ø© Ø¹Ù„Ù‰ Ø³Ø·Ø± (Ù…Ø«Ù„: 123 Ø£Ùˆ [Ù¡Ù¢Ù£] Ø£Ùˆ - 5 -)
            const pattern1 = new RegExp('^\\s*([\\[\\(\\-\\.]\\s*)?' + allDigits + '+(\\s*[\\)\\]\\-\\.]|\\s*)?\\s*$', 'gm');
            
            // Ø§Ù„Ù†Ù…Ø· 2: Ø£Ø±Ù‚Ø§Ù… ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø³Ø·Ø±
            const pattern2 = new RegExp('(\\s+' + allDigits + '+\\s*)$', 'gm');
            
            // Ø§Ù„Ù†Ù…Ø· 3: Ø£Ø±Ù‚Ø§Ù… ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø³Ø·Ø±
            const pattern3 = new RegExp('(^\s*' + allDigits + '+\\s+)', 'gm');


            let lines = newText.split('\n');
            let cleanedLines = [];
            
            lines.forEach(line => {
                if (line.trim().match(pattern1)) {
                    linesProcessed++;
                } else {
                    cleanedLines.push(line);
                }
            });
            
            newText = cleanedLines.join('\n');

            newText = newText.replace(pattern2, '');
            newText = newText.replace(pattern3, '');

            
            fileContentTextarea.value = newText;
            
            alert(`âœ… ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© ØªØ±Ù‚ÙŠÙ… Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ø¹Ø±Ø¨ÙŠ ÙˆØ¥Ù†Ø¬Ù„ÙŠØ²ÙŠ). ØªÙ… Ø­Ø°Ù Ø­ÙˆØ§Ù„ÙŠ ${linesProcessed} Ø³Ø·Ø± Ø¨Ø´ÙƒÙ„ ÙƒØ§Ù…Ù„ØŒ ÙˆØªÙ†Ø¸ÙŠÙ Ø§Ù„ØªØ±Ù‚ÙŠÙ… Ù…Ù† Ø¨Ø¯Ø§ÙŠØ§Øª ÙˆÙ†Ù‡Ø§ÙŠØ§Øª Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©.`);
        }
        
        function removeSoftLineBreaks() {
            const contentTextarea = document.getElementById('fileContent');
            let text = contentTextarea.value;

            if (text.trim() === "") {
                alert("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù„Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡.");
                return;
            }

            const softBreakRegex = /([^.?!:Ø›ØŒ\/)\-]\s*)\n+/gm;
            let newText = text.replace(softBreakRegex, '$1 ');
            newText = newText.replace(/\s{2,}/g, ' ');

            contentTextarea.value = newText;
            
            alert("âœ… ØªÙ… Ø¥Ø²Ø§Ù„Ø© ÙÙˆØ§ØµÙ„ Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ø²Ø§Ø¦Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ¯Ù…Ø¬ Ø§Ù„ÙÙ‚Ø±Ø§Øª.");
        }


        function downloadModifiedText() {
            const textToSave = fileContentTextarea.value;
            
            if (textToSave.trim() === "") {
                alert("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù„ØªÙ†Ø²ÙŠÙ„Ù‡.");
                return;
            }

            const blob = new Blob([textToSave], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            
            let downloadName = originalFileName;
            
            if (downloadName.toLowerCase().endsWith('.txt')) {
                downloadName = downloadName.replace(/\.txt$/i, '_CLEANED.txt');
            } else {
                downloadName += '_CLEANED.txt';
            }
            
            a.download = downloadName;

            document.body.appendChild(a);
            a.click();
            
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert(`ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­ Ø¨Ø§Ø³Ù…: ${a.download}`);
        }
    </script>

</body>
</html>
